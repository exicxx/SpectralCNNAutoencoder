# SpectralCNNAutoencoder


`SpectralCNNAutoencoder` is a Python project designed for analyzing spectral data using a Convolutional  autoencoder (CAE). This tool identifies and visualizes anomalies in spectral data by reconstructing spectra, highlighting anomalous regions, and overlaying associated galaxy images from the Sloan Digital Sky Survey (SDSS).

## Features

- **Autoencoder Model for Spectra**: Train a CAE to compress and reconstruct spectral data.
`SpectralCNNAutoencoder` is a Python project designed for analyzing spectral data using a Convolutional Neural Network (CNN) autoencoder. This tool identifies and visualizes anomalies in spectral data by reconstructing spectra, highlighting anomalous regions, and overlaying associated galaxy images from the Sloan Digital Sky Survey (SDSS).

## Features

- **Autoencoder Model for Spectra**: Train a CNN autoencoder to compress and reconstruct spectral data.
- **Anomaly Detection**: Detects anomalies based on reconstruction residuals and custom thresholds, allowing fine control over anomaly sensitivity.
- **Visualization**:
  - Generates superimposed plots of original and reconstructed spectra, with highlighted residuals.
  - Provides options to plot only anomalous spectra.
  - Fetches and displays SDSS galaxy images next to spectra.
  - Saves plots with unique file names to prevent overwrites.
- **Customizable Parameters**: Control thresholds, plotting options, and sample size.

## Getting Started

### Prerequisites

- **Python 3.x**
- **Dependencies**: Install the required packages using:
  
  ```bash
  pip install -r requirements.txt
  ```

### Installation

Clone the repository:

```bash
git clone https://github.com/your-username/SpectralCNNAutoencoder.git
cd SpectralCNNAutoencoder
```

Install dependencies if you haven’t already:

```bash
pip install -r requirements.txt
```

### Opening the Notebook

1. Open the Jupyter notebook by running:

   ```bash
   jupyter notebook SpectralCNNAutoencoder.ipynb
   ```

2. Follow the cells in the notebook to run each step of the process: model setup, anomaly detection, and visualization.

## Usage

The following steps are performed in the notebook.

### 1. Model Initialization and Training

The notebook initializes and trains the autoencoder on the spectral data. After training, it reconstructs the spectra.

### 2. Anomaly Detection

After evaluating the model, the notebook compares original and reconstructed spectra to detect anomalies based on user-defined thresholds.

### 3. Visualization and Plotting

The notebook includes a function `plot_spectra` to visualize original and reconstructed spectra, with residuals and associated galaxy images side-by-side.

#### File Saving

A helper function in the notebook, `create_save_path`, ensures saved files have unique names by appending a sequential numeric suffix.

### 4. Metadata Saving

The notebook allows saving metadata, anomaly detection thresholds, and sampling information for reproducibility.

## Directory Structure

- **Notebook**: `SpectralCNNAutoencoder.ipynb` – contains all code for model training, anomaly detection, and visualization.
- **SpectralCNNAutoencoder_output/**: Stores plots generated by the notebook.
- **metadata/**: Saves metadata files related to anomaly detection.

## Contributing

Contributions are welcome! Please submit a pull request or open an issue for bug fixes or feature requests.
